import{_ as s,o as a,c as n,Q as p}from"./chunks/framework.681fc4ae.js";const C=JSON.parse('{"title":"归档和备份","description":"","frontmatter":{},"headers":[],"relativePath":"bash/archives/archiving.md","filePath":"bash/archives/archiving.md"}'),l={name:"bash/archives/archiving.md"},o=p(`<h1 id="归档和备份" tabindex="-1">归档和备份 <a class="header-anchor" href="#归档和备份" aria-label="Permalink to &quot;归档和备份&quot;">​</a></h1><h2 id="gzip" tabindex="-1">gzip <a class="header-anchor" href="#gzip" aria-label="Permalink to &quot;gzip&quot;">​</a></h2><p>gzip 程序用来压缩文件，原文件的压缩版（添加<code>gz</code>后缀名）会替代原文件。gunzip 程序用来还原压缩版本。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gzip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo.txt</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gunzip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo.txt.gz</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gzip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo.txt</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gunzip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo.txt.gz</span></span></code></pre></div><p><code>gzip</code>的参数如下。</p><ul><li>-c 把输出写入到标准输出，并且保留原始文件。也有可能用--stdout 和--to-stdout 选项来指定。</li><li>-d 解压缩。正如 gunzip 命令一样。也可以用--decompress 或者--uncompress 选项来指定.</li><li>-f 强制压缩，即使原始文件的压缩文件已经存在了，也要执行。也可以用--force 选项来指定。</li><li>-h 显示用法信息。也可用--help 选项来指定。</li><li>-l 列出每个被压缩文件的压缩数据。也可用--list 选项。</li><li>-r 若命令的一个或多个参数是目录，则递归地压缩目录中的文件。也可用--recursive 选项来指定。</li><li>-t 测试压缩文件的完整性。也可用--test 选项来指定。</li><li>-v 显示压缩过程中的信息。也可用--verbose 选项来指定。</li><li>-number 设置压缩指数。number 是一个在1（最快，最小压缩）到9（最慢，最大压缩）之间的整数。 数值1和9也可以各自用--fast 和--best 选项来表示。默认值是整数6。</li></ul><p>下面是一些例子。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 查看解压缩后的内容</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gunzip</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">less</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 查看解压缩后的内容</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gunzip</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo.txt</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">less</span></span></code></pre></div><p><code>zcat</code>程序等同于带有-c 选项的 gunzip 命令。它可以像<code>cat</code>命令那样，用来查看<code>gzip</code>压缩文件。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zcat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo.txt.gz</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">less</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zcat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo.txt.gz</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">less</span></span></code></pre></div><h2 id="bzip2" tabindex="-1">bzip2 <a class="header-anchor" href="#bzip2" aria-label="Permalink to &quot;bzip2&quot;">​</a></h2><p><code>bzip2</code>程序与<code>gzip</code>程序相似，但是使用了不同的压缩算法，舍弃了压缩速度，实现了更高的压缩级别。在大多数情况下，它的工作模式等同于<code>gzip</code>。 由<code>bzip2</code>压缩的文件，用扩展名<code>.bz2</code>表示。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bzip2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo.txt</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bunzip2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo.txt.bz2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bzip2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo.txt</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bunzip2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo.txt.bz2</span></span></code></pre></div><p>gzip程序的所有选项（除了<code>-r</code>），bzip2 程序同样也支持。同样有 bunzip2 和 bzcat 程序来解压缩文件。bzip2 文件也带有 bzip2recover 程序，其会 试图恢复受损的 .bz2 文件。</p><h2 id="zip" tabindex="-1">zip <a class="header-anchor" href="#zip" aria-label="Permalink to &quot;zip&quot;">​</a></h2><p><code>zip</code>程序既是压缩工具，也是一个打包工具，读取和写入.zip文件。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">options</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zipfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">file...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">options</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zipfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file...</span></span></code></pre></div><p>它的用法如下。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 将指定目录压缩成zip文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zip</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground.zip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 将指定目录压缩成zip文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zip</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground.zip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground</span></span></code></pre></div><p><code>zip</code>与<code>tar</code>命令有一个相反之处。如果压缩文件已存在，其将被更新而不是被替代。这意味着会保留此文件包，但是会添加新文件，同时替换匹配的文件。</p><p>解压使用<code>unzip</code>命令。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">unzip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">../playground.zip</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">unzip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">../playground.zip</span></span></code></pre></div><p><code>unzip</code>命令的参数如下。</p><ul><li><code>-l</code> 列出文件包中的内容而不解压</li><li><code>-v</code> 显示冗余信息</li><li><code>-p</code> 输出发送到标准输出</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">unzip</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ls-etc.zip</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">less</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">unzip</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ls-etc.zip</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">less</span></span></code></pre></div><h2 id="tar" tabindex="-1">tar <a class="header-anchor" href="#tar" aria-label="Permalink to &quot;tar&quot;">​</a></h2><p><code>tar</code>是tape archive的简称，原来是一款制作磁带备份的工具，现在主要用于打包。一个 tar 包可以由一组独立的文件，一个或者多个目录，或者两者混合体组成。</p><p><code>tar</code>程序的语法如下。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mode[options]</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pathname...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mode[options]</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pathname...</span></span></code></pre></div><p>tar支持以下模式。</p><ul><li>c 表示create，为文件和／或目录列表创建归档文件。</li><li>x 抽取归档文件。</li><li>r 追加具体的路径到归档文件的末尾。</li><li>t 列出归档文件的内容。</li></ul><p>支持的参数如下。</p><ul><li>f 表示file，用来指定生成的文件。</li></ul><p>模式和参数可以写在一起，而且不需要开头的短横线。注意，必须首先指定模式，然后才是其它的选项。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 创建子目录的tar包</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground.tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看tar包内容</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看更详细的列表信息</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 还原归档文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 还原单个文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pathname</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 还原文件到指定目录</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-C</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home/me/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 追加文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 验证归档文件内容是否正确</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tvfW</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 支持通配符</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">../playground2.tar</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--wildcards</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;home/me/playground/\\*.txt&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 创建子目录的tar包</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground.tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看tar包内容</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看更详细的列表信息</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 还原归档文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 还原单个文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pathname</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 还原文件到指定目录</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-C</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home/me/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 追加文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 验证归档文件内容是否正确</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tvfW</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 支持通配符</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">../playground2.tar</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--wildcards</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;home/me/playground/\\*.txt&#39;</span></span></code></pre></div><p>注意，<code>tar</code>命令还原的时候，总是还原为相对路径。如果归档的时候，保存的是绝对路径，那么还原的时候，这个绝对路径会整个变成相对路径。</p><p><code>find</code>命令可以与<code>tar</code>命令配合使用。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">find</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;file.txt&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-exec</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground.tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{}&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;+&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">find</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;file.txt&#39;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-exec</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground.tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{}&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;+&#39;</span></span></code></pre></div><p>上面的命令先用<code>find</code>程序找到所有名为<code>file.txt</code>的文件，然后使用追加模式（<code>r</code>）的<code>tar</code>命令，把匹配的文件添加到归档文件<code>playground.tar</code>里面。</p><p>这种<code>tar</code>和<code>find</code>的配合使用，可以创建逐渐增加的目录树或者整个系统的备份。通过<code>find</code>命令匹配新于某个时间戳的文件，我们就能够创建一个归档文件，其只包含新于上一个 tar 包的文件。</p><p>tar支持压缩功能。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 打成gzip压缩包</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">czvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">assets.tar.gz</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dist</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 打成bz2压缩包</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cvfj</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">assets.tar.bz2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dist</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 解压 tar.gz 文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xzv</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.gz</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 解压bz2压缩包</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.bz2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 显示gzip压缩包内容</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 显示bz2压缩包内容</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.bz2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 从gzip压缩包取出单个文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zxvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.gz</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 从bz2压缩包取出单个文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">jxvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.bz2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 按通配符取出文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zxvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.gz</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--wildcards</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;*.php&#39;</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">jxvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.bz2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--wildcards</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;*.php&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 追加文件到压缩包</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.gz</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xyz.txt</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archive.tar.bz2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xyz.txt</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 打成gzip压缩包</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">czvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">assets.tar.gz</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dist</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 打成bz2压缩包</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cvfj</span><span style="color:#24292E;"> </span><span style="color:#032F62;">assets.tar.bz2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dist</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 解压 tar.gz 文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xzv</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.gz</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 解压bz2压缩包</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.bz2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 显示gzip压缩包内容</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 显示bz2压缩包内容</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.bz2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 从gzip压缩包取出单个文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zxvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.gz</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 从bz2压缩包取出单个文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">jxvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.bz2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 按通配符取出文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zxvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.gz</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--wildcards</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;*.php&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">jxvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.bz2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--wildcards</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;*.php&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 追加文件到压缩包</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.gz</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xyz.txt</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archive.tar.bz2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xyz.txt</span></span></code></pre></div><h2 id="rsync" tabindex="-1">rsync <a class="header-anchor" href="#rsync" aria-label="Permalink to &quot;rsync&quot;">​</a></h2><p><code>rsync</code>命令用于在多个目录之间、或者本地与远程目录之间同步。字母<code>r</code>表示<code>remote</code>。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rsync</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">options</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">source</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">destination</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rsync</span><span style="color:#24292E;"> </span><span style="color:#032F62;">options</span><span style="color:#24292E;"> </span><span style="color:#032F62;">source</span><span style="color:#24292E;"> </span><span style="color:#032F62;">destination</span></span></code></pre></div><p>source 和 destination 是下列选项之一：</p><ul><li>一个本地文件或目录</li><li>一个远端文件或目录，以<code>[user@]host:path</code>的形式存在</li><li>一个远端 rsync 服务器，由<code>rsync://[user@]host[:port]/path</code>指定</li></ul><p>注意 source 和 destination 两者之一必须是本地文件。rsync 不支持远端到远端的复制。</p><p><code>rsync</code>命令的参数如下。</p><ul><li><code>-a</code> 递归和保护文件属性</li><li><code>-v</code> 冗余输出</li><li><code>--delete</code> 删除可能在备份设备中已经存在但却不再存在于源设备中的文件</li><li><code>--rsh=ssh</code> 使用 ssh 程序作为远程 shell，目的地必须标注主机名。</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 同步两个本地目录</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rsync</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-av</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">playground</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">foo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 删除源设备不存在的文件</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rsync</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-av</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/usr/local</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/media/BigDisk/backup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 远程同步</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rsync</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-av</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--delete</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rsh=ssh</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/usr/local</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">remote-sys:/backup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 与远程rsync主机同步</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rsync</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-av</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rsync://rsync.gtlib.gatech.edu/path/to/oss</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">fedora-devel</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 同步两个本地目录</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rsync</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-av</span><span style="color:#24292E;"> </span><span style="color:#032F62;">playground</span><span style="color:#24292E;"> </span><span style="color:#032F62;">foo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 删除源设备不存在的文件</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rsync</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-av</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/usr/local</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/media/BigDisk/backup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 远程同步</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rsync</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-av</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--delete</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rsh=ssh</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/usr/local</span><span style="color:#24292E;"> </span><span style="color:#032F62;">remote-sys:/backup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 与远程rsync主机同步</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rsync</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-av</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rsync://rsync.gtlib.gatech.edu/path/to/oss</span><span style="color:#24292E;"> </span><span style="color:#032F62;">fedora-devel</span></span></code></pre></div>`,51),e=[o];function c(t,r,y,E,i,F){return a(),n("div",null,e)}const h=s(l,[["render",c]]);export{C as __pageData,h as default};
