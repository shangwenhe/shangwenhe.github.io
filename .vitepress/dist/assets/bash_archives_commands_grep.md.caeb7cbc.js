import{_ as s,o as a,c as p,Q as n}from"./chunks/framework.681fc4ae.js";const g=JSON.parse('{"title":"grep","description":"","frontmatter":{},"headers":[],"relativePath":"bash/archives/commands/grep.md","filePath":"bash/archives/commands/grep.md"}'),o={name:"bash/archives/commands/grep.md"},l=n(`<h1 id="grep" tabindex="-1">grep <a class="header-anchor" href="#grep" aria-label="Permalink to &quot;grep&quot;">​</a></h1><p><code>grep</code>命令用于文件内容的搜索，返回所有匹配的行。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pattern</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">filename</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pattern</span><span style="color:#24292E;"> </span><span style="color:#032F62;">filename</span></span></code></pre></div><p>下面是一个例子。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">admin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/passwd</span></span>
<span class="line"><span style="color:#B392F0;">_kadmin_admin:*:218:-2:Kerberos</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Admin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Service:/var/empty:/usr/bin/</span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">_kadmin_changepw:*:219:-2:Kerberos</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Change</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Password</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Service:/var/empty:/usr/bin/</span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">_krb_kadmin:*:231:-2:Open</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Directory</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Kerberos</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Admin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Service:/var/empty:/usr/bin/</span><span style="color:#79B8FF;">false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">admin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/passwd</span></span>
<span class="line"><span style="color:#6F42C1;">_kadmin_admin:*:218:-2:Kerberos</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Admin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Service:/var/empty:/usr/bin/</span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">_kadmin_changepw:*:219:-2:Kerberos</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Change</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Password</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Service:/var/empty:/usr/bin/</span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">_krb_kadmin:*:231:-2:Open</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Directory</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Kerberos</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Admin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Service:/var/empty:/usr/bin/</span><span style="color:#005CC5;">false</span></span></code></pre></div><p>一般情况下，应该使用<code>grep -R</code>，递归地找出当前目录下符合<code>someVar</code>的文件。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-FR</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;someVar&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-FR</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;someVar&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span></span></code></pre></div><p>別忘了大小不敏感的参数，因为 <code>grep</code> 默认搜索是大小写敏感的。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-iR</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;somevar&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-iR</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;somevar&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span></span></code></pre></div><p>也可以用<code>grep -l</code>光打印出符合条件的文件名而非文件内容选段。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-lR</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;somevar&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-lR</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;somevar&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span></span></code></pre></div><p>如果你写的脚本或批处理任务需要上面的输出内容，可以使用 <code>while</code> 和 <code>read</code> 来处理文件名中的空格和其他特殊字符：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-lR</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">someVar</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> IFS</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">read</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">file</span><span style="color:#E1E4E8;">; </span><span style="color:#F97583;">do</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">head</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">$file</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#F97583;">done</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-lR</span><span style="color:#24292E;"> </span><span style="color:#032F62;">someVar</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> IFS</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file</span><span style="color:#24292E;">; </span><span style="color:#D73A49;">do</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">head</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">$file</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#D73A49;">done</span></span></code></pre></div><p>如果你在你的项目里使用了版本控制软件，它通常会在 <code>.svn</code>， <code>.git</code>， <code>.hg</code> 目录下包含一些元数据。你也可以很容易地用 <code>grep -v</code> 把这些目录移出搜索范围，当然得用 <code>grep -F</code> 指定一个恰当且确定的字符串，即要移除的目录名：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;someVar&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-vF</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;.svn&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;someVar&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-vF</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;.svn&#39;</span></span></code></pre></div><p>部分版本的 <code>grep</code> 包含了 <code>--exclude</code> 和 <code>--exclude-dir</code> 选项，这看起来更加易读。</p><h2 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-label="Permalink to &quot;参数&quot;">​</a></h2><p><code>-i</code>参数表示忽略大小写。</p><p><code>-r</code>表示搜索某个目录下面的所有文件。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">admin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#032F62;">admin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/</span></span></code></pre></div><p><code>-v</code>过滤包含某个词的行，即<code>grep</code>的逆操作。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 显示所有包含 vim，但不包含 grep 的行</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ps</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 显示所有包含 vim，但不包含 grep 的行</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ps</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">vim</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span></span></code></pre></div><p><code>-exclude-dir</code> 排除查找目录</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;xxx/token&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--exclude-dir=</span><span style="color:#9ECBFF;">&#39;*/node_modules&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--exclude-dir=</span><span style="color:#9ECBFF;">&#39;*/build&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;xxx/token&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--exclude-dir=</span><span style="color:#032F62;">&#39;*/node_modules&#39;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--exclude-dir=</span><span style="color:#032F62;">&#39;*/build&#39;</span></span></code></pre></div>`,24),e=[l];function c(r,t,y,E,i,d){return a(),p("div",null,e)}const h=s(o,[["render",c]]);export{g as __pageData,h as default};
